from tkinter import*
from tkinter import ttk
import tkinter.messagebox
import pymysql
import random
import time
import mysql.connector
import pyodbc
from decimal import Decimal
import pandas as pd
import numpy as np
from tkinter import filedialog


def ataskaitos():
    master = Tk()
    master.geometry("1280x720")
    master.geometry("800x680+0+0")
    master.configure(background = 'gainsboro')



    MainFrame1 = Frame(master, bd = 10, width = 800, height = 680, relief = RIDGE)
    MainFrame1.grid()


    TopFrame5 = Frame(MainFrame1, bd = 5, width = 780, height = 900, relief = RIDGE, bg ='cadet blue')
    TopFrame5.grid(row = 0, column = 0)
    InnerTopFrame5 = Frame(TopFrame5, bd = 5, width = 770, height = 900, relief = RIDGE)
    InnerTopFrame5.grid()

    # scroll_x1 = Scrollbar(InnerTopFrame5, orient = HORIZONTAL)
    # scroll_y1 = Scrollbar(InnerTopFrame5, orient = VERTICAL)

    # scroll_x1.pack(side = BOTTOM, fill = X)
    # scroll_y1.pack(side = RIGHT, fill = Y)

    # # scroll_x1 = ttk.Scrollbar(master, orient = "vertical")
    # # scroll_y1 = ttk.Scrollbar(master, orient = "horizontal")

    tree_records1 = ttk.Treeview(InnerTopFrame5, height = 12, columns = ("Pavadinimas", "Sum of Kaina", "Sum of Kiekis"), xscrollcommand = scroll_x1.set, yscrollcommand = scroll_y1.set)

    tree_records1.heading("Pavadinimas", text = "Pavadinimas")
    tree_records1.heading("Sum of Kaina", text = "Sum of Kaina")
    tree_records1.heading("Sum of Kiekis", text = "Sum of Kiekis")

    tree_records1['show'] = "headings"

    df = pd.read_excel(r"C:/Users/justa/Desktop/Report.xlsx")
    df.head()
    pd.pivot_table(df,index=["Row Labels"])
    tree_records1.insert('', END, text='Listbox', values=df.head(22))
    print(df.head(22))

    # tree_records1.column("Kurinys.Pavadinimas", width = 300, anchor = tkinter.W)
    # tree_records1.column("Viso_nupirko", width = 80, anchor = tkinter.W)
    # tree_records1.column("Perka.Kaina", width = 80, anchor = tkinter.W)
    # tree_records1.column("Knyga.Formatas", width = 80, anchor = tkinter.CENTER)

    # tree_records1.pack(fill = BOTH, expand = 1)


    # conn = pyodbc.connect(
    #     "Driver={SQL Server Native Client 11.0};"
    #     "Server=LAPTOP-EGR3M9P8\MSSQLSERVER01;"
    #     "Database=Knygynas;"
    #     "Trusted_Connection=yes;"
    # )
    # cur = conn.cursor()
    # cur.execute("""SELECT Kurinys.Pavadinimas, COUNT(*) AS Viso_nupirko, cast(Perka.Kaina as float) AS Vienos_knygos_kaina, Knyga.Formatas
    #             FROM Perka, Knyga, Leidinys, Kurinys
    #             WHERE Perka.Knyga_ID = Knyga.Knyga_ID
    #                 AND Knyga.Leidinys_ID = Leidinys.Leidinys_ID
    #                 AND Leidinys.Kurinys_ID = Kurinys.Kurinys_ID
    #             GROUP BY Kurinys.Pavadinimas, Perka.Kaina, Knyga.Formatas
    #             ORDER BY Viso_nupirko DESC""")
    # results = cur.fetchall()
    # if len(results) != 0:
    #     for row in results:
    #         list = [elem for elem in row]
    #         tree_records1.insert('', END, text='Listbox', values=list)
    #         conn.commit()
    #     conn.close()